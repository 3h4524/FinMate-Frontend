<!-- Modern Sidebar Component -->
<div id="sidebar" class="fixed h-screen bg-white shadow-xl transition-all duration-300 flex flex-col z-40 top-16" style="width: 256px;">
    <!-- Logo - Hidden when header is present -->
    <div class="logo-section flex items-center justify-between p-6 border-b border-gray-100 hidden">
        <div class="flex items-center space-x-3">
            <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center">
                <i class="fas fa-dollar-sign text-white text-lg"></i>
            </div>
            <div id="sidebar-text" class="transition-all duration-300">
                <h1 class="text-xl font-bold text-gray-800">FinMate</h1>
                <p class="text-xs text-gray-500">Financial Manager</p>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 p-4 pt-6">
        <div class="space-y-2">
            <!-- User Menu Items (Hidden for Admin) -->
            <div class="user-menu-section">
                <!-- Dashboard -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg"
                        data-page="dashboard" onclick="window.location.href='/pages/home/'">
                    <i class="fas fa-home w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Dashboard</span>
                </button>

                <!-- Transactions -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="transactions" onclick="window.location.href='/pages/transaction/'">
                    <i class="fas fa-exchange-alt w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Transactions</span>
                </button>

                <!-- Goals -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="goals" onclick="window.location.href='/pages/goal/'">
                    <i class="fas fa-bullseye w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Goals</span>
                </button>

                <!-- Budget -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="budget" onclick="window.location.href='/pages/budget/'">
                    <i class="fas fa-calculator w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Budget</span>
                </button>

                <!-- Reports -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="reports" onclick="window.location.href='/pages/financial_report/'">
                    <i class="fas fa-chart-bar w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Reports</span>
                </button>

                <!-- Premium Plan -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="premium" onclick="window.location.href='/pages/user_premium/'">
                    <i class="fas fa-crown w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Premium Plan</span>
                </button>

                <!-- Recurring Transactions -->
                <button class="sidebar-item user-menu w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="recurring-transaction" onclick="window.location.href='/pages/recurring-transaction/'">
                    <i class="fas fa-sync-alt w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Recurring Transactions</span>
                </button>
            </div>

            <!-- Admin Menu Items (Hidden by default) -->
            <div class="admin-menu hidden">
                <!-- Admin Dashboard -->
                <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg"
                        data-page="admin-dashboard" onclick="window.location.href='/pages/admin-dashboard/'">
                    <i class="fas fa-tachometer-alt w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Admin Dashboard</span>
                </button>

                <!-- User Management -->
                <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="user-management" onclick="window.location.href='/pages/user-management/'">
                    <i class="fas fa-users-cog w-5 h-5"></i>
                    <span class="sidebar-label font-medium">User Management</span>
                </button>

                <!-- System Logs -->
                <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="system-log" onclick="window.location.href='/pages/system-log/'">
                    <i class="fas fa-clipboard-list w-5 h-5"></i>
                    <span class="sidebar-label font-medium">System Logs</span>
                </button>

                <!-- Subscription Manager -->
                <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="subscription-manager" onclick="window.location.href='/pages/subscription-manager/'">
                    <i class="fas fa-star w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Subscription Manager</span>
                </button>

                <!-- Coupon Manager -->
                <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800" data-page="coupon" onclick="window.location.href='/pages/coupon/'">
                    <i class="fas fa-ticket-alt w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Coupon Manager</span>
                </button>

                <!-- Features -->
                <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-gray-600 hover:bg-gray-100 hover:text-gray-800"
                        data-page="feature" onclick="window.location.href='/pages/feature/'">
                    <i class="fas fa-cogs w-5 h-5"></i>
                    <span class="sidebar-label font-medium">Features</span>
                </button>
            </div>

        </div>
    </nav>

    <!-- Logout Section - Always at bottom -->
    <div class="p-4 border-t border-gray-200">
        <button class="sidebar-item w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-red-600 hover:bg-red-50 hover:text-red-700"
                onclick="handleLogout()">
            <i class="fas fa-sign-out-alt w-5 h-5"></i>
            <span class="sidebar-label font-medium">Logout</span>
        </button>
    </div>

    <!-- User Profile - Simplified when header is present -->
    <div id="user-profile" class="p-4 border-t border-gray-100 transition-all duration-300 hidden">
        <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-colors" id="viewProfileBtn">
            <div class="w-10 h-10 bg-gradient-to-r from-green-400 to-blue-500 rounded-full flex items-center justify-center">
                <i class="fas fa-user text-white text-sm"></i>
            </div>
            <div class="flex-1 sidebar-text">
                <p class="font-medium text-gray-800 user-name">Loading...</p>
                <p class="text-sm text-gray-500">Premium</p>
            </div>
        </div>

        <!-- Logout Button -->
        <button
                class="w-full mt-3 flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 text-red-600 hover:bg-red-50 hover:text-red-700"
                onclick="handleLogout()"
        >
            <i class="fas fa-sign-out-alt w-5 h-5"></i>
            <span class="sidebar-label font-medium">Logout</span>
        </button>
    </div>
</div>

<!-- Overlay for mobile -->
<div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden lg:hidden"></div>

<style>
    /* Sidebar Styles - YouTube Integration */
    .sidebar-collapsed {
        width: 80px !important;
    }

    .sidebar-collapsed .sidebar-text,
    .sidebar-collapsed .sidebar-label {
        opacity: 0;
        width: 0;
        overflow: hidden;
        display: none !important;
    }

    .sidebar-collapsed #user-profile {
        padding: 1rem 0.5rem;
    }

    .sidebar-collapsed #user-profile .flex-1 {
        display: none;
    }

    /* Hide elements that are hidden by JavaScript even in collapsed state */
    .sidebar-collapsed .sidebar-item[style*="display: none"],
    .sidebar-collapsed .user-menu[style*="display: none"],
    .sidebar-collapsed .user-menu-section[style*="display: none"],
    .sidebar-collapsed .admin-menu[style*="display: none"] {
        display: none !important;
    }

    /* Collapsed sidebar adjustments - Force override all Tailwind classes */
    .sidebar-collapsed .sidebar-item {
        padding: 0 !important;
        margin: 0.25rem auto !important;
        width: 48px !important;
        height: 48px !important;
        min-width: 48px !important;
        min-height: 48px !important;
        max-width: 48px !important;
        max-height: 48px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        text-align: center !important;
        border-radius: 0.75rem !important;
        position: relative !important;
        overflow: hidden !important;
        box-sizing: border-box !important;
    }

    /* Override display flex for hidden items */
    .sidebar-collapsed .sidebar-item[style*="display: none"] {
        display: none !important;
    }

    /* Override Tailwind space-x classes */
    .sidebar-collapsed .sidebar-item > * {
        margin-left: 0 !important;
        margin-right: 0 !important;
    }

    .sidebar-collapsed .sidebar-item i {
        margin: 0 !important;
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
        z-index: 2 !important;
        width: auto !important;
        height: auto !important;
    }

    .sidebar-collapsed .logo-section .w-10 {
        width: 2rem !important;
        height: 2rem !important;
    }

    .sidebar-collapsed .logo-section {
        justify-content: center;
        padding: 1rem 0.5rem !important;
    }

    /* Mobile Sidebar */
    @media (max-width: 1024px) {
        #sidebar {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
            top: 0; /* Full height on mobile */
            height: 100vh;
        }

        #sidebar.sidebar-open {
            transform: translateX(0);
        }

        #sidebar-overlay.overlay-visible {
            display: block;
        }

        /* Show logo section on mobile when no header */
        #sidebar .logo-section {
            display: flex !important;
        }

        /* Show user profile on mobile */
        #sidebar #user-profile {
            display: block !important;
        }
    }

    /* Desktop Integration with Header */
    @media (min-width: 1025px) {
        #sidebar {
            top: 64px; /* Header height */
            height: calc(100vh - 64px);
        }

        /* Hide logo and user profile on desktop with header */
        #sidebar .logo-section,
        #sidebar #user-profile {
            display: none;
        }
    }

    .sidebar-item.active {
        background: linear-gradient(to right, #3b82f6, #8b5cf6) !important;
        color: white !important;
        box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.39);
    }

    .sidebar-item.active i,
    .sidebar-item.active span {
        color: white !important;
    }

    .sidebar-item {
        position: relative;
        overflow: hidden;
        border: none;
        background: none;
        text-align: left;
    }

    .sidebar-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(to right, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
        transition: left 0.3s ease;
        border-radius: 0.75rem;
    }

    .sidebar-item:hover::before {
        left: 0;
    }

    /* Collapsed sidebar hover effects */
    .sidebar-collapsed .sidebar-item::before {
        content: '' !important;
        position: absolute !important;
        top: 0 !important;
        left: -48px !important;
        width: 48px !important;
        height: 48px !important;
        background: linear-gradient(to right, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1)) !important;
        border-radius: 0.75rem !important;
        transition: left 0.3s ease !important;
        z-index: 1 !important;
        box-sizing: border-box !important;
    }

    .sidebar-collapsed .sidebar-item:hover::before {
        left: 0 !important;
    }

    /* Logo section adjustments for collapsed state */
    .sidebar-collapsed .logo-section {
        justify-content: center;
        padding: 1rem 0.5rem !important;
    }

    .sidebar-collapsed .logo-section .w-10 {
        width: 2rem !important;
        height: 2rem !important;
        margin: 0 auto;
    }

    #sidebar-container {
        width: 256px;
        height: 100vh;
        position: fixed;
        left: 0;
        top: 0;
        z-index: 40;
        overflow: hidden;
    }

    /* Smooth transitions for all sidebar animations */
    #sidebar {
        transition: width 0.3s ease, transform 0.3s ease;
    }

    /* Content margin adjustment for sidebar */
    .content-with-sidebar {
        margin-left: 256px;
        transition: margin-left 0.3s ease;
    }

    .content-with-sidebar.sidebar-collapsed {
        margin-left: 80px;
    }

    @media (max-width: 1024px) {
        .content-with-sidebar,
        .content-with-sidebar.sidebar-collapsed {
            margin-left: 0;
        }
    }
</style>